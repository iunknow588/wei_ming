<view class="container">
  <!-- æ‘‡é’±èµ·å¦é¡µé¢ -->
  <view class="divination-header">
    <view class="header-title">æ‘‡é’±èµ·å¦</view>
  </view>

  <!-- å…è´£å£°æ˜æç¤ºæ¡ -->
  <view class="disclaimer-banner" tt:if="{{showDisclaimer}}">
    <view class="disclaimer-content">
      <text class="disclaimer-text">{{disclaimerText}}</text>
      <view class="disclaimer-close" bindtap="onCloseDisclaimer">âœ•</view>
    </view>
  </view>

  <!-- èµ·å¦æŒ‡å¯¼ï¼Œæ”¾åœ¨æ ‡é¢˜ä¸‹æ–¹ -->
  <view class="guidance">
    <view class="guidance-title">èµ·å¦æŒ‡å¯¼</view>
    <view class="guidance-content">
      <view class="guidance-item">1. é›†ä¸­ç²¾ç¥ï¼Œé»˜æƒ³æ‰€æ±‚æµ‹ä¹‹äº‹</view>
      <view class="guidance-item">2. ç‚¹å‡»"æ‘‡å¦"æŒ‰é’®å¼€å§‹æ‘‡å¦</view>
      <view class="guidance-item">3. ç­‰å¾…é“œé’±åœæ­¢æ—‹è½¬</view>
      <view class="guidance-item">4. é‡å¤å…­æ¬¡å®Œæˆæ•´ä¸ªå¦è±¡</view>
    </view>
  </view>

  <!-- èµ·å¦æç¤º -->
  <view class="divination-subtitle">
    <view class="header-subtitle">è¯·é›†ä¸­æ„å¿µï¼Œé»˜æƒ³æ‰€æ±‚æµ‹ä¹‹äº‹</view>
  </view>

  <!-- é“œé’±åŒºåŸŸ -->
  <view class="coins-container">
    <view class="coin-wrapper" tt:for="{{coins}}" tt:key="index">
      <view class="coin {{item.isSpinning ? 'spinning' : ''}}" bindtap="onCoinTap" data-index="{{index}}">
        <image 
          class="coin-face {{item.showFront ? 'front' : 'back'}}" 
          src="{{item.showFront ? wuZhu1 : wuZhu2}}" 
          mode="aspectFit"
        />
      </view>
      <view class="coin-label">é“œé’±{{index + 1}}</view>
    </view>
  </view>

  <!-- æ“ä½œæŒ‰é’®ï¼ˆæ‘‡å¦å’Œä¿å­˜å¹¶æ’æ˜¾ç¤ºï¼‰ -->
  <view class="action-buttons">
    <view class="action-btn divination-btn {{isDivinationDisabled ? 'disabled' : ''}}" bindtap="onDivination">
      <view class="btn-icon">
        <image class="coin-icon" src="/assets/coin.png" mode="aspectFit"></image>
      </view>
      <view class="btn-text">{{currentRound >= totalRounds ? 'é‡æ–°æ‘‡å¦' : 'æ‘‡å¦'}}</view>
    </view>
    <!-- ä¿å­˜å¦è±¡æŒ‰é’®ï¼Œä¸€ç›´å­˜åœ¨ä½†æ ¹æ®çŠ¶æ€ç°åŒ– -->
    <view class="action-btn save-btn {{currentRound < totalRounds ? 'disabled' : ''}} {{isCurrentGuaSaved ? 'saved' : ''}}" bindtap="onSaveCoinDivinationToUserData">
      <view class="btn-icon">{{isCurrentGuaSaved ? 'âœ…' : 'ğŸ’¾'}}</view>
      <view class="btn-text"><text>ä¿å­˜</text><text>å¦è±¡</text></view>
    </view>
  </view>

  <!-- çˆ»ç»“æœæ˜¾ç¤ºåŒºåŸŸ -->
  <view class="yao-display-area">
    <view class="yao-display-title">çˆ»è±¡ç»“æœï¼ˆä»åº•å‘ä¸Šï¼‰</view>
    <view class="yao-display-content">
      <!-- ä»åº•å‘ä¸Šæ˜¾ç¤ºçˆ»è±¡ï¼ŒæŒ‰ç…§ä¼ ç»Ÿæ˜“å­¦ä¹ æƒ¯ -->
      <view class="yao-item {{item.isEmpty ? 'empty' : ''}}" tt:for="{{yaoResults}}" tt:key="index">
        <view class="yao-number">{{item.number}}</view>
        <view class="yao-symbol {{item.result.type}}" tt:if="{{!item.isEmpty}}">{{item.result.symbol}}</view>
        <view class="yao-symbol empty" tt:if="{{item.isEmpty}}">â€”</view>
        <view class="yao-desc" tt:if="{{!item.isEmpty}}">{{item.result.desc}}</view>
        <view class="yao-desc empty" tt:if="{{item.isEmpty}}">å¾…æ‘‡å¦</view>
        <!-- æ˜¾ç¤ºé“œé’±çŠ¶æ€ -->
        <view class="coin-status" tt:if="{{!item.isEmpty && item.result.coinStatusText}}">
          <text class="coin-status-text">[{{item.result.coinStatusText}}]</text>
        </view>
      </view>
      <!-- æ˜¾ç¤ºå½“å‰è¿›åº¦ -->
      <view class="yao-progress" tt:if="{{currentRound < totalRounds}}">
        <view class="progress-text">è¿›åº¦: {{currentRound}}/{{totalRounds}}</view>
        <view class="progress-bar">
          <view class="progress-fill" style="width: {{(currentRound / totalRounds) * 100}}%"></view>
        </view>
      </view>
    </view>
  </view>

  <!-- é¡µé¢åº•éƒ¨æ“ä½œæŒ‰é’®åŒº -->
  <view class="footer-action-buttons">
    <view class="action-btn" bindtap="onViewBianGua">
      <view class="btn-icon">ğŸ“–</view>
      <view class="btn-text"><text>å˜å¦</text><text>åŸç†</text></view>
    </view>
    <view class="action-btn" bindtap="onNewDivination">
      <view class="btn-icon">ğŸ”„</view>
      <view class="btn-text"><text>é‡æ–°</text><text>èµ·å¦</text></view>
    </view>
    <view class="action-btn result-btn {{currentRound < totalRounds ? 'disabled' : ''}}" bindtap="onResultAnalysis">
      <view class="btn-icon">ğŸ“Š</view>
      <view class="btn-text"><text>ç»“æœ</text><text>è§£æ</text></view>
    </view>
  </view>

  <!-- ç»“æœåŒºåŸŸ -->
  <!-- å·²è¿ç§»åˆ° result-analysis é¡µé¢ï¼ŒåŸåœ°åˆ é™¤ -->
</view> 